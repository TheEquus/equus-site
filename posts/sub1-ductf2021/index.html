<!doctype html><html lang=en data-mode=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="The road to becoming a crypto master is a fun journey, but still no easy feat. So, I decided to begin this journey by doing a challenge from DUCTF 2021 called &#34;Substitution Cipher I&#34;, using a tool few people have used to solve crypto challenges, despite it almost having &#34;maths&#34; in its name"><meta property="og:title" content="Path to a crypto master, the engineer way"><meta property="og:description" content="The road to becoming a crypto master is a fun journey, but still no easy feat. So, I decided to begin this journey by doing a challenge from DUCTF 2021 called &#34;Substitution Cipher I&#34;, using a tool few people have used to solve crypto challenges, despite it almost having &#34;maths&#34; in its name"><meta property="og:image" content="https:/anniequus.com/posts/sub1-ductf2021/media/cover.jpg"><meta property="og:url" content="https://anniequus.com/posts/sub1-ductf2021/"><meta name=twitter:card content="summary_large_image"><title>Path to a crypto master, the engineer way</title>
<link rel=canonical href=https://anniequus.com/posts/sub1-ductf2021/><link rel=preload href=https://anniequus.com/fonts/AnonymousPro-Regular.ttf as=font crossorigin=anonymous><link rel=preload href=https://anniequus.com/fonts/Heebo-VariableFont_wght.ttf as=font crossorigin=anonymous><link rel=preload href=https://anniequus.com/fonts/Rubik-VariableFont_wght.ttf as=font crossorigin=anonymous><link rel=stylesheet href=https://anniequus.com/css/main.min.438d8614614734b73815278dc3c64b0220335c8c5e5168baefe118fb203f84bb.css integrity="sha256-Q42GFGFHNLc4FSeNw8ZLAiAzXIxeUWi67+EY+yA/hLs=" crossorigin=anonymous><script defer src=https://anniequus.com/js/main.min.cf29f7226a9c2b2d20303d20e6fdd133796cbbd092dfd7486f2e01b089ffe03d.js integrity="sha256-zyn3ImqcKy0gMD0g5v3RM3lsu9CS39dIby4BsIn/4D0=" crossorigin=anonymous></script></head><body><header id=navbar><h1><a href=https://anniequus.com/>Equus üê¥ (Annie)</a></h1><ul><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li></ul></header><a href=# id=backtotop></a><div class=content><main><article><header><h1>Path to a crypto master, the engineer way</h1><section class=terms><a class=btn href=/categories/ctf/>CTF</a></section><p>Published on <time datetime=2021-09-26>2021-09-26</time></p></header><details class=toc open><summary class=outline-dashed>Table of Contents</summary><nav id=TableOfContents><ul><li><a href=#the-beginning>The Beginning</a><ul><li><a href=#understanding-the-sage>Understanding the sage</a></li><li><a href=#neat-ify-the-cipher-text>Neat-ify the cipher text</a></li></ul></li><li><a href=#oh-no>Oh no</a><ul><li><a href=#an-unnatural-call>An unnatural call</a></li><li><a href=#an-unholy-solve>An unholy solve</a></li></ul></li></ul></nav></details><p><img src=media/chall.png alt="Challenge info" loading=lazy>
Who knew I&rsquo;d be writing a crypto writeup.</p><h2 id=the-beginning>The Beginning</h2><p>The challenge provides a SageMath bit of code, as well as a cipher text.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>encrypt</span>(msg, f):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(chr(f<span style=color:#f92672>.</span>substitute(c)) <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> msg)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>P<span style=color:#f92672>.&lt;</span>x<span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> PolynomialRing(ZZ)
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> <span style=color:#ae81ff>13</span><span style=color:#f92672>*</span>x<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>*</span>x <span style=color:#f92672>+</span> <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FLAG <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;./flag.txt&#39;</span>, <span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>enc <span style=color:#f92672>=</span> encrypt(FLAG, f)
</span></span><span style=display:flex><span>print(enc)
</span></span></code></pre></div><p><img src=media/CipherText.png alt="Hex output of cipher text" loading=lazy>
That&rsquo;s some messy looking cipher text&mldr;</p><h3 id=understanding-the-sage>Understanding the sage</h3><p>Thankfully the SageMath here is nice and short. All that we need to know, is that each character of the flag is thrown into the encryption function <code>f</code>. So to reverse it, we just do the opposite.<br>Since the values were obtained by substituting each character into <code>13*x^2 + 3*x + 7</code>, to get x back, we solve <code>13*x^2 + 3*x + 7 = &lt;encrypted num></code>.</p><h3 id=neat-ify-the-cipher-text>Neat-ify the cipher text</h3><p>Those bytes looked a little unpleasant to me, so I decided to turn them into their appropriate unicode values.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>txt <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;output.txt&#34;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>nums <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> chr <span style=color:#f92672>in</span> txt:
</span></span><span style=display:flex><span>    nums<span style=color:#f92672>.</span>append(ord(chr))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(nums)
</span></span></code></pre></div><p><code>nums = [60323, 94187, 58565, 91987, 63917, 197053, 172277, 140927, 30103, 178315, 151963, 130307, 19897, 181373, 33973, 117617, 178315, 172277, 33973, 130307, 117617, 169297, 30103, 175283, 117617, 31367, 33973, 203507, 10]</code><br>Now that&rsquo;s much better. Now to simply reverse the values and &mldr;</p><h2 id=oh-no>Oh no</h2><h3 id=an-unnatural-call>An unnatural call</h3><p>I then felt a disturbance in the air. My computer was absorbed by a bright, blinding light. When my senses recovered I saw this:
<img src=media/Matlab.png alt="Be thankful you aren't seeing MATLAB blinding your eyes with their very white UI" loading=lazy>
I guess I have no choice now. The call of engineers can not be ignored.</p><h3 id=an-unholy-solve>An unholy solve</h3><p>Matlab thankfully has a very simple way of solving quadratic equations. Using the <code>root()</code> function, in addition to rounding, I summoned the following code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span>nums <span style=color:#f92672>=</span> [<span style=color:#ae81ff>60323</span>, <span style=color:#ae81ff>94187</span>, <span style=color:#ae81ff>58565</span>, <span style=color:#ae81ff>91987</span>, <span style=color:#ae81ff>63917</span>, <span style=color:#ae81ff>197053</span>, <span style=color:#ae81ff>172277</span>, <span style=color:#ae81ff>140927</span>, <span style=color:#ae81ff>30103</span>, <span style=color:#ae81ff>178315</span>, <span style=color:#ae81ff>151963</span>, <span style=color:#ae81ff>130307</span>, <span style=color:#ae81ff>19897</span>, <span style=color:#ae81ff>181373</span>, <span style=color:#ae81ff>33973</span>, <span style=color:#ae81ff>117617</span>, <span style=color:#ae81ff>178315</span>, <span style=color:#ae81ff>172277</span>, <span style=color:#ae81ff>33973</span>, <span style=color:#ae81ff>130307</span>, <span style=color:#ae81ff>117617</span>, <span style=color:#ae81ff>169297</span>, <span style=color:#ae81ff>30103</span>, <span style=color:#ae81ff>175283</span>, <span style=color:#ae81ff>117617</span>, <span style=color:#ae81ff>31367</span>, <span style=color:#ae81ff>33973</span>, <span style=color:#ae81ff>203507</span>, <span style=color:#ae81ff>10</span>];
</span></span><span style=display:flex><span>results <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#a6e22e>length</span>(nums)
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>results</span>(i) <span style=color:#f92672>=</span> <span style=color:#66d9ef>char</span>(<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>max</span>(<span style=color:#a6e22e>roots</span>([<span style=color:#ae81ff>13</span> <span style=color:#ae81ff>3</span> (<span style=color:#ae81ff>7</span><span style=color:#f92672>-</span><span style=color:#a6e22e>nums</span>(i))]))));
</span></span><span style=display:flex><span>end
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sprintf</span>(<span style=color:#e6db74>&#34;%s&#34;</span>,results)
</span></span></code></pre></div><p>And just like that, the blinding light disappeared, and a flag emerged&mldr;
<code>DUCTF{sh0uld'v3_us3d_r0t_13}</code></p><p>What have I done&mldr;</p></article></main></div></body></html>